<div class="container">
  <br>

  <div *ngIf=tram>
    <p class = 'centre'> <b>TRAM NUMERO: {{tram.num}}</b> ({{tram.name}})</p>
      <table width = "100%" class = "table1">
        <tr>
          <td class = 'obert' *ngIf = 'tram.state == "Obert"'> OBERT </td>
          <td *ngIf = 'tram.state != "Obert"' (click)="openTram()"> OBERT </td>
          <td class = 'escombra' *ngIf = 'tram.state == "Escombrant"'> ESCOMBRANT </td>
          <td *ngIf = 'tram.state != "Escombrant"' (click)="pasEscombra()"> ESCOMBRANT </td>
          <td class = 'tancat' *ngIf = 'tram.state == "Tancat"'> TANCAT </td>
          <td *ngIf = 'tram.state != "Tancat"' (click)="closeTram()"> TANCAT </td>
          <td class = 'obert' *ngIf='tram.avituallament && tram.avituallament_rebut' width = "50%"> AVITUALLAMENT </td>
          <td class = 'tancat' *ngIf = 'tram.avituallament && !tram.avituallament_rebut' width = "50%"> AVITUALLAMENT </td>
          <td class = 'obert' *ngIf = 'tram.material_rebut'> MATERIAL </td>
          <td class = 'tancat' *ngIf = '!tram.material_rebut'> MATERIAL </td>
        </tr>
      </table>

      <table width="100%" class = "table2">
        <tr>
          <td class = 'obert' *ngIf = 'tram.state == "Obert"'> OBERT </td>
          <td *ngIf = 'tram.state != "Obert"' (click)="openTram()"> OBERT </td>
        </tr>
        <tr>
          <td class = 'escombra' *ngIf = 'tram.state == "Escombrant"'> ESCOMBRANT </td>
          <td *ngIf = 'tram.state != "Escombrant"' (click)="pasEscombra()"> ESCOMBRANT </td>
        </tr>
        <tr>
          <td class = 'tancat' *ngIf = 'tram.state == "Tancat"'> TANCAT </td>
          <td *ngIf = 'tram.state != "Tancat"' (click)="closeTram()"> TANCAT </td>
        </tr>
        <tr>
          <td class = 'obert' *ngIf='tram.avituallament && tram.avituallament_rebut' width = "50%"> AVITUALLAMENT </td>
          <td class = 'tancat' *ngIf = 'tram.avituallament && !tram.avituallament_rebut' width = "50%"> AVITUALLAMENT </td>
        </tr>
        <tr>
          <td class = 'obert' *ngIf = 'tram.material_rebut'> MATERIAL </td>
          <td class = 'tancat' *ngIf = '!tram.material_rebut'> MATERIAL </td>
        </tr>
      </table>

      <p> </p>
      <p> </p>
      <p> <b> Incid√®ncies: </b> {{numIncidents}} <button class = "butt" (click)='navigateToDetails()'> CREAR INCIDENT </button> </p>

      <table *ngIf = incidents class ="table1">
        <tr>
          <th> CATEGORY </th>
          <th> DESCRIPCIO </th>
          <th> SOLVED </th>
          <th> COMMENTS </th>
        </tr>
        <tr *ngFor = 'let inc of incidents' width = '100%'>
          <td> {{inc.category}} </td>
          <td> {{inc.description}} </td>
          <td (click)='changeState(inc._id)'> {{inc.solved}} </td>
          <div *ngIf = inc.comments>
            <tr *ngFor = 'let comm of inc.comments'>
              <td> {{comm.username}}: {{comm.comment}}</td>
            </tr>
          </div>
        </tr>
      </table>

      <table width = "100%" class = 'table2' *ngFor='let incident of incidents'>
        <tr>
          <th>TRAM</th>
          <td> {{incident.tram_num}} </td>
        </tr>
        <tr>
          <th> CATEGORY </th>
          <td> {{incident.category}} </td>
        </tr>
        <tr>
          <th>DESCRIPCIO</th>
          <td> {{incident.description}} </td>
        </tr>
        <tr>
          <th> SOLVED </th>
          <td *ngIf = '!incident.solved'(click)='changeState(incident._id)'> {{ incident.solved }} </td>
          <td *ngIf = 'incident.solved'> {{ incident.solved }} </td>
        </tr>
        <tr>
          <td colspan="2"> <b> COMMENTS </b> </td>
        </tr>
        <tr *ngFor = 'let comm of incident.comments'>
          <td colspan="2"> {{comm.username}}: {{comm.comment}} </td>
        </tr>
      </table>
  </div>
</div>
